<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles.css">
    <script
      src="http://code.jquery.com/jquery-3.2.1.min.js"
      integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
      crossorigin="anonymous">
    </script>
  </head>
  <body>
    <h1>IP Address Locator</h1>
    <p>Get your IP Info:
      <button id="getInfo">
        GO!
      </button>
    </p>
    <p>Get info from a custom IP:
      <input id="customIP" defaultValue="" type="text"/>
      <button id="getCustomInfo">GO!</button>
    </p>
    <div id="map"></div>
    <div id="ipInfo"></div>
  </body>
  <script>
    var map;
    
    function getIPinfo(url) {
      $.getJSON(url, function(data) {
        console.log(data);
        if (data.error) return;
        var latlng = new google.maps.LatLng(data.latitude,data.longitude)
        map.panTo(latlng);
        map.setZoom(6);
        var marker = new google.maps.Marker({
          position: latlng,
          map: map
        })
        var infoHTML = '';
        for (var key in data) {
          infoHTML += '<p>' + key +': ' + data[key] + '</p>';
        }
        $('#ipInfo').html(infoHTML);
      })
      .fail(function(jqXHR, textStatus, errorThrown) { 
        console.log('getJSON request failed! ' + textStatus); 
        console.log("incoming "+jqXHR.responseText);
      })
    }
    $(document).ready(function() {
      $('#getInfo').click(function() {
          getIPinfo('https://ipapi.co/json')
//         getIPinfo('https://freegeoip.net/json/')
//         getIPinfo('https://ipinfo.io/json')
      });
      
      $('#getCustomInfo').click(function() {
        var customIP = $('#customIP').val();
        getIPinfo('https://ipapi.co/' + customIP + '/json')
      });
    })
  </script>
  <script>
      function initMap() {
        var centerUS = {lat: 39.50, lng: -98.35};
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 3,
          center: centerUS
        });
      }
  </script>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACz_kSTiCdCMT1Vm9kuhHSmjSbCKOiY28&callback=initMap">
  </script>
</html>